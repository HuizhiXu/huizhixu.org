<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>KNOW HOW on 徐慧志的个人博客</title><link>https://huizhixu.github.io/chs/know_how/</link><description>Recent content in KNOW HOW on 徐慧志的个人博客</description><generator>Hugo</generator><language>chs</language><lastBuildDate>Fri, 17 Oct 2025 12:50:41 +0000</lastBuildDate><atom:link href="https://huizhixu.github.io/chs/know_how/index.xml" rel="self" type="application/rss+xml"/><item><title>2025-10-17 月之暗面的OK Computer还可以更好</title><link>https://huizhixu.github.io/chs/know_how/20251017%E6%9C%88%E4%B9%8B%E6%9A%97%E9%9D%A2%E7%9A%84ok-computer%E8%BF%98%E5%8F%AF%E4%BB%A5%E6%9B%B4%E5%A5%BD/</link><pubDate>Fri, 17 Oct 2025 12:50:41 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20251017%E6%9C%88%E4%B9%8B%E6%9A%97%E9%9D%A2%E7%9A%84ok-computer%E8%BF%98%E5%8F%AF%E4%BB%A5%E6%9B%B4%E5%A5%BD/</guid><description>&lt;p&gt;体验了一下Moonshot新推出的OK computer，这个产品最大的特点是端到端训练，model as agent，在训练时就已经把agent的能力融入到模型里面了。&lt;/p&gt;
&lt;p&gt;OK Computer说自己能够独立完成网站开发、数据分析、图像视频生成及高质量PPT制作。它的定位为“你专属的AI产品与工程团队“，但是交付的形式是产品本身，而不是像TRAE一样交付的是代码。&lt;/p&gt;
&lt;p&gt;我给它的第一个任务是做一个PPT，因为8月份我用过kimi里面的PPT助手，想对比看一下这次的提升。&lt;/p&gt;
&lt;p&gt;8月份那次制作PPT，要自己选择模版、上传文档，而kimi只能大概做一个基础性的框架，内容很少，图片和表格都需要手动补充。&lt;/p&gt;
&lt;p&gt;这一次不需要选择模版，直接上传文档，我给的指令很简单，是“帮我根据文档进行生成PPT”，就开始了。最终生成的6页幻灯片，风格令人惊艳，知识点拆解也重点突出。整体效果比起8月份那次，真的进步太多。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20251017/36797f09.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20251017/e8df851b.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;我给的第二个任务是让它把一段文本做成绘本。&lt;/p&gt;
&lt;p&gt;官网有一个例子是把以前的课文《口技》做成绘本，有图像，也有环境音，感觉很生动。&lt;/p&gt;
&lt;p&gt;我仿照官网案例，尝试将杨千嬅的歌曲《河童》制成一个可交互的水彩风网页绘本。《河童》这首歌有画面，有意境，很适合AI创作。&lt;/p&gt;
&lt;p&gt;我用的提示词是官网的《口技》的例子修改而来。&lt;/p&gt;
&lt;p&gt;虽然这是个网页版agent，但是有一个可视化界面，左边是任务的规划和完成情况，会先创立一个任务列表，然后一项一项的执行，执行完打勾。右边是实时界面，可以看到这个过程生成的所有的文档、图片和音频等。&lt;/p&gt;
&lt;p&gt;任务列表：&lt;/p&gt;
&lt;p&gt;执行过程中中的所有文件都能浏览，最后也可以打包下载。&lt;/p&gt;
&lt;p&gt;最终出来的结果是这样的，看到时我感觉超出了预期。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20251017/c43d9970.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;总的画面是这样的，还是很美的。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20251017/af7fa845.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;第一幕还蛮好的，有画面，有互动，有音乐。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20251017/9e5ba6eb.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;但是接着问题就出现了，点击“下一幕”后，URL显示已进入第二个页面，但画面仍停留在第一个。反馈修复了之后也依然不行。并且发现额度已经用完了。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20251017/1785576d.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;OK Computer展现的能力是强大的。生成了详细的任务清单，并逐步执行，最终输出了包括13张插图、13段音效及完整网页代码在内的成品，中间的步骤我看了，它生成的交互文档和专业设计文档都十分全面，任务执行也精准到位。&lt;/p&gt;
&lt;p&gt;唯一遗憾的是，即便遵循了官方优秀案例，最终成品仍存在影响使用的前端Bug，距离完美仅一步之遥。这一步之遥让我纠结这会员到底开还是不开啊。&lt;/p&gt;</description></item><item><title>2025-09-11 Anthropic 做 Multi Agent 系统的工程经验（下）</title><link>https://huizhixu.github.io/chs/know_how/20250911anthropic-%E5%81%9A-multi-agent-%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B7%A5%E7%A8%8B%E7%BB%8F%E9%AA%8C%E4%B8%8B/</link><pubDate>Thu, 11 Sep 2025 12:50:53 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250911anthropic-%E5%81%9A-multi-agent-%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B7%A5%E7%A8%8B%E7%BB%8F%E9%AA%8C%E4%B8%8B/</guid><description>&lt;p&gt;这一篇写Anthropic的智能体评估、生产可靠性和工程挑战。&lt;/p&gt;
&lt;h1 id="智能体评估"&gt;智能体评估&lt;/h1&gt;
&lt;p&gt;如何做智能体评估呢？传统的做法是“给定输入 X，必须走步骤 Y，才能得到正确输出 Z”。但是多智能体不能这样做，因为它没有固定唯一的、可预先写死的解题路径。&lt;/p&gt;
&lt;h2 id="评估什么"&gt;评估什么&lt;/h2&gt;
&lt;p&gt;不要去检查是否走了预设的路径，而要判断是否有合理的过程和正确的结果。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;结果导向：最终答案是否正确、是否满足用户需求。&lt;/li&gt;
&lt;li&gt;过程合理性：虽然允许路径变化，但要确保路径在逻辑、效率、成本、可靠性上“说得通”。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="从小样本集上就开始做评估"&gt;从小样本集上就开始做评估&lt;/h2&gt;
&lt;p&gt;不要等数据量大时才开始做评估，在小样本的时候就开始做评估&lt;/p&gt;
&lt;h2 id="llm-as-judge"&gt;LLM AS JUDGE&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;研究输出的评估难题：研究输出通常是自由形式的文本，很难通过程序化的方法进行评估，因为它们很少有唯一正确的答案。&lt;/li&gt;
&lt;li&gt;LLM作为评判工具的适用性：LLM 由于其强大的语言理解和生成能力，非常适合用于评估这种复杂的研究输出。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="打分规则"&gt;打分规则&lt;/h3&gt;
&lt;p&gt;Anthropic 制定了一些打分规则：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;事实准确性（说法是否与来源一致？）&lt;/li&gt;
&lt;li&gt;引用准确性（引用来源是否真的支撑该说法？）&lt;/li&gt;
&lt;li&gt;完整性（是否涵盖了所有要求的内容？）&lt;/li&gt;
&lt;li&gt;来源质量（是否优先使用了高质量的一手资料，而不是低质量的二手资料？）&lt;/li&gt;
&lt;li&gt;工具效率（是否用了恰当的工具、调用次数是否合理？）
评分方式：LLM评判工具会根据上述标准对每个输出进行评分，评分范围为0.0到1.0，并给出通过或不通过的等级。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;实验与优化&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;多评委实验：最初尝试使用多个LLM评判工具来评估每个标准，但发现这种方法不够一致，与人类评判结果的对齐度也不够高。&lt;/li&gt;
&lt;li&gt;单评委优化：最终发现，使用单个LLM评判工具，通过一个单一的提示（prompt）来输出评分和通过/不通过的等级，是最一致且与人类评判结果最接近的方法。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="人工评估的重要性"&gt;人工评估的重要性&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;自动化评估的局限性：
自动化评估工具（如LLM评判工具）虽然高效，但可能会遗漏一些边缘情况（edge cases）。这些情况包括：&lt;/li&gt;
&lt;li&gt;人工评估的优势：&lt;/li&gt;
&lt;li&gt;多智能体系统的复杂性&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="生产可靠性和工程挑战"&gt;生产可靠性和工程挑战&lt;/h1&gt;
&lt;p&gt;在传统软件里，一个小 bug 可能仅仅让功能崩溃、性能下降或触发一次故障。&lt;/p&gt;
&lt;p&gt;而在agentic 系统里，微小的改动会像滚雪球一样放大，引发巨大的行为漂移——这使得为那些需要在长时间运行中保持状态的复杂智能体编写可靠代码变得异常困难。&lt;/p&gt;
&lt;h2 id="1-增加故障点原地恢复的功能"&gt;1. 增加故障点原地恢复的功能&lt;/h2&gt;
&lt;p&gt;智能体可能长时间运行，在多次工具调用之间持续保持状态。这意味者必须保证代码的持久执行，并在每一步都能妥善处理错误。&lt;/p&gt;
&lt;p&gt;出错时，不能简单地“重启”：重启太昂贵了。所以Anthropic 构建了一套可从故障点原地恢复的系统，并加上了重试逻辑和定期快照来保证断点恢复的功能。&lt;/p&gt;
&lt;h2 id="2-开发全链路追踪"&gt;2. 开发全链路追踪&lt;/h2&gt;
&lt;p&gt;在传统软件里，同样的输入基本会得到同样的输出，可 AI 智能体是“动态、非确定性”的——同一套提示词跑两次，内部决策路径都可能不同，于是调试难度成倍上升。 举个例子：用户投诉“智能体连显而易见的资料都找不到”。光凭日志根本看不出问题出在哪——是它生成了糟糕的搜索关键词？还是选到了垃圾网页？还是工具本身调用失败？&lt;/p&gt;
&lt;p&gt;Anthropic 引入了一套“全链路追踪（full production tracing）”，记录每一次调用、每一个决策节点（关键词→结果→评分→下一步动作），但不记录对话正文，保证用户隐私。&lt;/p&gt;
&lt;p&gt;好处：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;能一眼看出“哦，原来失败都是因为它把 PDF 当网页解析导致失败”之类的根本原因；&lt;/li&gt;
&lt;li&gt;能发现“两个子智能体反复互相踢皮球”这种事先没想到的异常协作；&lt;/li&gt;
&lt;li&gt;把常见失败归纳成模式后，就可以系统性地修 bug、改提示、补工具，而不是靠猜。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="3-部署的时候要考虑用户正在使用"&gt;3. 部署的时候要考虑用户正在使用&lt;/h2&gt;
&lt;p&gt;考虑到无论什么时候发布更新都有可能有用户在使用智能体，Anthropic 采用“彩虹部署（rainbow deployments）”：旧版本和新版本同时在线，逐步将流量从旧实例切到新实例，从而避免打断正在运行的智能体。&lt;/p&gt;
&lt;h2 id="4-同步执行与异步执行"&gt;4. 同步执行与异步执行&lt;/h2&gt;
&lt;h3 id="同步执行优点"&gt;同步执行优点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;流程简洁：主智能体按固定顺序等待全部子智能体返回即可，调度与调试成本较低。&lt;/li&gt;
&lt;li&gt;状态一致：所有子任务一次性完成，输出天然对齐，无需额外的合并步骤。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="同步执行挑战"&gt;同步执行挑战&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;吞吐受限：任一子智能体延迟即拖慢全局，系统整体并行度受限。&lt;/li&gt;
&lt;li&gt;缺乏弹性：主智能体无法在运行过程中动态修正子智能体的目标；子智能体之间亦无法实时共享信息或协同。&lt;/li&gt;
&lt;li&gt;资源闲置：当大部分子智能体已结束而少数仍在执行时，算力与带宽均被阻塞，利用率下降。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="异步执行优点"&gt;异步执行优点&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;并行度显著提升，各子智能体可独立推进并按需衍生新任务；&lt;/li&gt;
&lt;li&gt;主智能体可实时接收中间结果，及时重定向或终止子任务，实现精细化控制；&lt;/li&gt;
&lt;li&gt;子智能体之间可通过消息机制即时协作，提高整体效率。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="异步执行挑战"&gt;异步执行挑战&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;结果汇总：需额外机制对无序到达的结果进行排序、去重与聚合；&lt;/li&gt;
&lt;li&gt;状态一致：分布式快照或事务协议保障全局视图同步，增加系统复杂度；&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="5-上下文管理"&gt;5. 上下文管理&lt;/h2&gt;
&lt;p&gt;当 AI 代理需要与用户进行几百轮对话时，如何让它“记住”前面发生的事，又不会因为上下文窗口塞不下而失效呢？&lt;/p&gt;</description></item><item><title>2025-09-10 Anthropic 做 Multi Agent系统的工程经验（上）</title><link>https://huizhixu.github.io/chs/know_how/20250910anthropic-%E5%81%9A-multi-agent%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B7%A5%E7%A8%8B%E7%BB%8F%E9%AA%8C%E4%B8%8A/</link><pubDate>Wed, 10 Sep 2025 12:50:47 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250910anthropic-%E5%81%9A-multi-agent%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B7%A5%E7%A8%8B%E7%BB%8F%E9%AA%8C%E4%B8%8A/</guid><description>&lt;p&gt;从ChatGPT时代到现在，大家逐渐达成共识：大模型的应用核心不是算法问题，而是工程问题。大模型本身作为基础设施已经就位，关键在于如何通过工程手段解决记忆存储、上下文管理、工具调用和提示词优化等实际问题。&lt;/p&gt;
&lt;p&gt;最近读了Anthropic关于多智能体系统的工程实践， 感觉很有意思，所以分享出来。这一篇将解析：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Multi Agent的架构设计（Orchestrator-Worker模式）&lt;/li&gt;
&lt;li&gt;Multi Agent的优劣势&lt;/li&gt;
&lt;li&gt;提示工程实践（8条 Anthropic 核心经验）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下一篇写Anthropic的智能体评估、产品可靠性和工程挑战。&lt;/p&gt;
&lt;h1 id="multi-agent-的架构"&gt;Multi Agent 的架构&lt;/h1&gt;
&lt;h3 id="orchestrator-worker模式解析"&gt;Orchestrator-Worker模式解析&lt;/h3&gt;
&lt;p&gt;Anthropic采用orchestrator-worker架构模式。&lt;/p&gt;
&lt;p&gt;在AI的论文中经常可以看见orchestrate这个单词。orchestrator的本义是是管弦乐的编曲者，是把一首乐曲改编成适合管弦乐队演奏、并为每种乐器分配合适声部和旋律的人。&lt;/p&gt;
&lt;p&gt;在这里orchestrator 引申为“负责总体调度、协调、编排所有子任务的组件，又叫lead agent（主智能体）。 worker是执行子任务的智能体，又叫subagent（子智能体）。&lt;/p&gt;
&lt;p&gt;主智能体作为系统的&amp;quot;指挥中心&amp;quot;，其核心职责包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;任务分解与分配&lt;/li&gt;
&lt;li&gt;资源协调与调度&lt;/li&gt;
&lt;li&gt;结果整合与决策
子智能体则专注于执行特定子任务，彼此并行工作，通过分工协作提升系统整体效率。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="架构图"&gt;架构图&lt;/h3&gt;
&lt;p&gt;下面是研究系统的架构图。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20250910/69ac33e7.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;如图所示，当用户提交查询时，主智能体会进行分析，制定策略，通过子智能体迭代使用搜索工具收集信息，然后将信息返回给主智能体，最后汇总成最终答案。&lt;/p&gt;
&lt;p&gt;多智能体与RAG的不同：&lt;/p&gt;
&lt;p&gt;检索增强生成 (RAG) 一种静态检索，它们会获取与输入查询最相似的一组词块，并使用这些词块生成响应。而多智能体架构采用多步骤搜索，可以动态地查找相关信息，适应新的发现，并分析结果以生成高质量的答案。&lt;/p&gt;
&lt;h3 id="交互流程"&gt;交互流程&lt;/h3&gt;
&lt;p&gt;下面是多智能体系统的交互流程，这里可以看出，除了不同的智能体、还有Memory模块和Citation Agent。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20250910/0c84baf9.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;步骤如下：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;当用户提交查询时，系统会创建一个 LeadResearcher（主研智能体），它进入迭代式研究循环。&lt;/li&gt;
&lt;li&gt;主研先思考整体方案，并把计划写入 Memory（记忆模块），以保证上下文被持久化——因为上下文窗口一旦超过 20 万 token 就会被截断，保留计划至关重要。&lt;/li&gt;
&lt;li&gt;主研创建若干专门的 Subagent（分研智能体，图中示例为 2 个，实际数量可任意），各自领取具体的子任务。&lt;/li&gt;
&lt;li&gt;每个分研独立执行网页搜索，并用“Interleaved thinking”的方式评估工具返回结果，随后将发现返回给主研。&lt;/li&gt;
&lt;li&gt;主研汇总这些结果，并判断是否需要继续研究；&lt;/li&gt;
&lt;li&gt;如需继续，它可以再创建新的分研或调整策略。当信息足够后，系统退出研究循环，把所有发现交给 CitationAgent（引用智能体）。&lt;/li&gt;
&lt;li&gt;引用智能体对文档和研究报告进行处理，为每一处需要引用的内容定位具体来源，确保所有结论都能追溯到出处。最终，带完整引用的研究结果返回给用户。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;值得一提的是，这里说到Interleaved thinking 是指交错思考。&lt;/p&gt;
&lt;p&gt;Claude 4 模型在调用工具（tool calls）时，不把“思考过程”一次性打包完，而是在每次得到工具返回结果之后，再插入一段新的思考（reasoning），然后再决定下一步要不要继续调用工具、调用哪一个工具。&lt;/p&gt;
&lt;p&gt;整个“思考—调用工具—再思考—再调用……”的流程像齿轮交错一样穿插进行，而不是传统的“先一口气想好所有步骤，再连续执行”。&lt;/p&gt;
&lt;h1 id="multi-agent的优劣势"&gt;Multi Agent的优劣势&lt;/h1&gt;
&lt;h3 id="为什么研究性的工作适合用multi-agent-来做"&gt;为什么研究性的工作适合用Multi Agent 来做？&lt;/h3&gt;
&lt;p&gt;因为研究工作主要涉及开放性的问题，研究者会根据在研究过程中出现的线索，持续更新自己的研究方法。&lt;/p&gt;</description></item><item><title>2025-06-16 Weaviate使用（四） RAG的两种处理方法</title><link>https://huizhixu.github.io/chs/know_how/20250616weaviate%E4%BD%BF%E7%94%A8_rag%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/</link><pubDate>Mon, 16 Jun 2025 12:50:37 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250616weaviate%E4%BD%BF%E7%94%A8_rag%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/</guid><description>&lt;p&gt;执行RAG操作过程中，对检索到的条目有两种处理方法：一种是single_prompt，另一种是grouped_tasks。&lt;/p&gt;
&lt;p&gt;grouped_task是对所有检索到的条目做一个整体的处理，例如&amp;quot;write a tweet about these facts&amp;quot;， &amp;ldquo;what do these movies have in common?&amp;quot;。&lt;/p&gt;
&lt;p&gt;single_prompt是对每一个检索到的object应用prompt。例如&amp;quot;translate this into French:{title}&amp;quot;。&lt;/p&gt;
&lt;h2 id="single-prompt"&gt;Single prompt&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# Single prompt&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;response &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; movies&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;generate&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;near_vector(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; near_vector&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;query_vector,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; limit&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;2&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; single_prompt &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Translate this into French:&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;{title}&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;for&lt;/span&gt; o &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; response&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;objects:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;print&lt;/span&gt;(o&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;properties[&lt;span style="color:#f1fa8c"&gt;&amp;#34;title&amp;#34;&lt;/span&gt;]) &lt;span style="color:#6272a4"&gt;# Print the title&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;print&lt;/span&gt;(o&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;generated) &lt;span style="color:#6272a4"&gt;# Print the generated text (the title, in French)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;结果为&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;I, Robot
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;The translation of &lt;span style="color:#f1fa8c"&gt;&amp;#34;I, Robot&amp;#34;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; French &lt;span style="color:#ff79c6"&gt;is&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Je, robot&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;Looper
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;The word &lt;span style="color:#f1fa8c"&gt;&amp;#34;Looper&amp;#34;&lt;/span&gt; translates to &lt;span style="color:#f1fa8c"&gt;&amp;#34;Loupé&amp;#34;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; French&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;从结果可以看出，找出来两个数据”I, Robot”和”Looper”，并且分别翻译成法语。&lt;/p&gt;</description></item><item><title>2025-06-15 Weaviate使用（三） 两种导入数据的方法</title><link>https://huizhixu.github.io/chs/know_how/20250615weaviate%E4%BD%BF%E7%94%A8_%E4%B8%A4%E7%A7%8D%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95/</link><pubDate>Sun, 15 Jun 2025 12:50:36 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250615weaviate%E4%BD%BF%E7%94%A8_%E4%B8%A4%E7%A7%8D%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95/</guid><description>&lt;p&gt;在导入的时候，可以先生成embedding，写入csv，然后在add_batch的时候添加。另外一种方法是在导入的时候直接embedding。&lt;/p&gt;
&lt;h2 id="第一种方法"&gt;第一种方法&lt;/h2&gt;
&lt;h3 id="先创建集合create-collection"&gt;先创建集合：Create collection&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; weaviate
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; weaviate.classes.config &lt;span style="color:#ff79c6"&gt;as&lt;/span&gt; wc
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;from&lt;/span&gt; weaviate.classes.config &lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; Configure
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;client &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; weaviate&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;connect_to_local()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;# client.collections.delete(&amp;#34;MovieCustomVector&amp;#34;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;client&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;collections&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;create(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;MovieCustomVector&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; properties&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;[
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Property(name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;title&amp;#34;&lt;/span&gt;, data_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataType&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;TEXT),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Property(name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;overview&amp;#34;&lt;/span&gt;, data_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataType&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;TEXT),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Property(name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;vote_average&amp;#34;&lt;/span&gt;, data_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataType&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;NUMBER),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Property(name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;genre_ids&amp;#34;&lt;/span&gt;, data_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataType&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;INT_ARRAY),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Property(name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;release_date&amp;#34;&lt;/span&gt;, data_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataType&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DATE),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Property(name&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;tmdb_id&amp;#34;&lt;/span&gt;, data_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;wc&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataType&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;INT),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; vectorizer_config&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;Configure&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Vectorizer&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;none(),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; generative_config&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;Configure&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;Generative&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;ollama(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; api_endpoint&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;http://host.docker.internal:11434&amp;#34;&lt;/span&gt;, model&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;llama3.2&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;client&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;close()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="对文本向量化和存储embed_text"&gt;对文本向量化和存储：embed_text&lt;/h3&gt;
&lt;p&gt;这一步组合标题和概述的内容作为要向量化的文本，向量化之后存为csv。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; pandas &lt;span style="color:#ff79c6"&gt;as&lt;/span&gt; pd
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; os
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;from&lt;/span&gt; FlagEmbedding &lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; BGEM3FlagModel
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;def&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;generate_embeddings&lt;/span&gt;(df: pd&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataFrame, batch_size: &lt;span style="color:#8be9fd;font-style:italic"&gt;int&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;50&lt;/span&gt;) &lt;span style="color:#ff79c6"&gt;-&amp;gt;&lt;/span&gt; pd&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataFrame:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;&amp;#34;&amp;#34;生成文本的向量表示
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt; Args:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt; df: 包含电影数据的DataFrame
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt; batch_size: 批处理大小
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt; Returns:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt; DataFrame: 包含所有embeddings的DataFrame
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt; &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; model &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; BGEM3FlagModel(&lt;span style="color:#f1fa8c"&gt;&amp;#34;BAAI/bge-m3&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; emb_dfs &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; src_texts &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; indices &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6272a4"&gt;# 批量处理文本&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;for&lt;/span&gt; i, row &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;enumerate&lt;/span&gt;(df&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;itertuples(index&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;False&lt;/span&gt;)):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6272a4"&gt;# 组合标题和概述&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; text &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;f&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;Title: &lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;{&lt;/span&gt;row&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;title&lt;span style="color:#f1fa8c"&gt;}&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;;Overview: &lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;{&lt;/span&gt;row&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;overview&lt;span style="color:#f1fa8c"&gt;}&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; src_texts&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;append(text)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; indices&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;append(i)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6272a4"&gt;# 达到批处理大小或处理完所有数据时进行向量化&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;if&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;len&lt;/span&gt;(src_texts) &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; batch_size &lt;span style="color:#ff79c6"&gt;or&lt;/span&gt; i &lt;span style="color:#ff79c6"&gt;+&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;1&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;len&lt;/span&gt;(df):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; embeddings &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; model&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;encode(src_texts)[&lt;span style="color:#f1fa8c"&gt;&amp;#34;dense_vecs&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; emb_df &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; pd&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;DataFrame(embeddings, index&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;indices)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; emb_dfs&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;append(emb_df)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; src_texts &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; indices &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; pd&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;concat(emb_dfs)&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;sort_index()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;def&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;main&lt;/span&gt;():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;&amp;#34;&amp;#34;主函数，处理电影数据并生成向量&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6272a4"&gt;# 读取数据&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; data_path &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; os&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;path&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;join(os&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;path&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;dirname(&lt;span style="color:#8be9fd;font-style:italic"&gt;__file__&lt;/span&gt;), &lt;span style="color:#f1fa8c"&gt;&amp;#34;scratch/movies_data_1990_2024.json&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; df &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; pd&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;read_json(data_path)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#6272a4"&gt;# 生成向量并保存&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; embeddings_df &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; generate_embeddings(df)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; os&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;makedirs(&lt;span style="color:#f1fa8c"&gt;&amp;#34;scratch&amp;#34;&lt;/span&gt;, exist_ok&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; embeddings_df&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;to_csv(&lt;span style="color:#f1fa8c"&gt;&amp;#34;scratch/movies_data_1990_2024_embeddings.csv&amp;#34;&lt;/span&gt;, index&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;False&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;if&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;__name__&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;==&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; main()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="导入数据import-data"&gt;导入数据：Import data&lt;/h3&gt;
&lt;p&gt;在导入数据(batch.add_object)的时候需要把 vector和property分别写入。另外uuid是数据库为每一条数据创建的不重复的id。&lt;/p&gt;</description></item><item><title>2025-06-14 Weaviate使用（二） 使用自定义模型</title><link>https://huizhixu.github.io/chs/know_how/20250614weaviate%E4%BD%BF%E7%94%A8_%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%A7%E6%A8%A1%E5%9E%8B/</link><pubDate>Sat, 14 Jun 2025 12:50:33 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250614weaviate%E4%BD%BF%E7%94%A8_%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%A7%E6%A8%A1%E5%9E%8B/</guid><description>&lt;p&gt;如果不想用Ollama启用的向量模型，想用自定义的模型有多种方法，下面介绍两种：一种是通过huggingface或者其他的框架导入，另一种是直接调用已有的向量调用的服务（例如用FastAPI启动）。&lt;/p&gt;
&lt;p&gt;把向量服务或者大模型封装成服务的好处是：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;功能解耦：大模型服务或者向量服务独立出来，在替换的时候无需更改代码&lt;/li&gt;
&lt;li&gt;环境解耦：大模型服务通常需要更多的资源。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这时的docker compose file 非常简单，不再需要ENABLE_MODULES: &amp;rsquo;text2vec-ollama,generative-ollama&amp;rsquo; 这一行。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;services&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; weaviate&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; command&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;host
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;0.0&lt;/span&gt;.&lt;span style="color:#bd93f9"&gt;0.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;port
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;8080&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;scheme
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; http
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; image&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; cr.weaviate.io&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;semitechnologies&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;weaviate&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;1.30&lt;/span&gt;.&lt;span style="color:#bd93f9"&gt;6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ports&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;8080&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;8080&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;50051&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;50051&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; volumes&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; weaviate_data&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;/var/lib/weaviate
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; restart&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; on&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;failure&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; environment&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; QUERY_DEFAULTS_LIMIT&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;25&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;true&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; PERSISTENCE_DATA_PATH&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;/var/lib/weaviate&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ENABLE_API_BASED_MODULES&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;true&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; CLUSTER_HOSTNAME&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;node1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;volumes&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; weaviate_data&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="通过hugging-face导入"&gt;通过hugging face导入&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;def vectorize(texts&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; List[str])&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; from FlagEmbedding &lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; BGEM3FlagModel
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; model &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; BGEM3FlagModel(&lt;span style="color:#f1fa8c"&gt;&amp;#39;BAAI/bge-m3&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; embeddings &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; model.encode(texts)[&lt;span style="color:#f1fa8c"&gt;&amp;#34;dense_vecs&amp;#34;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; embeddings
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="通过api调用"&gt;通过API调用&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;class&lt;/span&gt; CustomEmbedding(EmbedGen)&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; def generate_embeddings(self, texts&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; List[str]) &lt;span style="color:#ff79c6"&gt;-&amp;gt;&lt;/span&gt; np.array&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; requests
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; json
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; payload &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; json.dumps(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;input&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; texts,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; headers &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; {&lt;span style="color:#f1fa8c"&gt;&amp;#34;Content-Type&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;application/json&amp;#34;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; response &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; requests.request(&lt;span style="color:#f1fa8c"&gt;&amp;#34;POST&amp;#34;&lt;/span&gt;, url&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;EMBED_URL, headers&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;headers, data&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; embeddings &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; [i[&lt;span style="color:#f1fa8c"&gt;&amp;#34;embedding&amp;#34;&lt;/span&gt;] &lt;span style="color:#ff79c6"&gt;for&lt;/span&gt; i &lt;span style="color:#ff79c6"&gt;in&lt;/span&gt; response.json()[&lt;span style="color:#f1fa8c"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;]]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; embeddings &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; np.array(embeddings)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; embeddings
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>2025-06-13 论文阅读BGE-M3</title><link>https://huizhixu.github.io/chs/know_how/20250613%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BBbge-m3/</link><pubDate>Fri, 13 Jun 2025 12:50:30 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250613%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BBbge-m3/</guid><description>&lt;p&gt;论文地址：https://arxiv.org/abs/2402.03216&lt;/p&gt;
&lt;p&gt;M3的意思是 Multi-Linguality, Multi-Functionality和Multi-Granularity&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;支持100种语言（multi-lingual, cross-lingual)&lt;/li&gt;
&lt;li&gt;支持短句和长文档，最高到8192tokesn&lt;/li&gt;
&lt;li&gt;支持不同的检索方法&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HuizhiXu/pictures/master/20250613/d5b741c9.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;(图来源于论文)&lt;/p&gt;
&lt;h1 id="contribution"&gt;Contribution&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;实现了自知识蒸馏，将来自不同检索功能的相关性分数集成到教师信号，从而提高训练质量。&lt;/li&gt;
&lt;li&gt;优化了批处理策略，实现较大的批处理大小和高训练吞吐量，以提高Embedding的区分能力。&lt;/li&gt;
&lt;li&gt;用data curation来得到高质量的数据&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="细节"&gt;细节&lt;/h1&gt;
&lt;h2 id="不同的向量检索方法"&gt;不同的向量检索方法&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;[CLS]用来做dense retrieval&lt;/li&gt;
&lt;li&gt;其他token的向量用来做sparse retrieval 和multi-vector retrieval&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="dataset-sources"&gt;Dataset sources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;extract the unsupervised data from massive multi-lingual corpora&lt;/li&gt;
&lt;li&gt;Integrate the closely related supervised data&lt;/li&gt;
&lt;li&gt;Synthesize the scarce data&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="self-knowledge-distillation"&gt;Self-Knowledge Distillation&lt;/h2&gt;
&lt;p&gt;InfoNCE loss 的目标是最大化正样本对的相似度，同时最小化负样本对的相似度。&lt;/p&gt;
&lt;p&gt;InfoNCE loss的计算&lt;/p&gt;
&lt;p&gt;$$Loss= -log \frac{ \exp(sim(x_i,x_i^+)/\tau) }{\sum_{j=1}^K \exp(sim(x_i, x_i^{-j})/\tau) }$$&lt;/p&gt;
&lt;p&gt;假设我们有一个数据集，其中每个样本 xi 有一个对应的正样本 $$x_i^+$$ 和多个负样本 $$x_i^{-1}, x_i^{-2}, &amp;hellip;, x_i^{-K} $$。&lt;/p&gt;
&lt;p&gt;对于每个样本 $$x_i$$，我们希望其与正样本 $$x_i^+ $$的相似度尽可能高。&lt;/p&gt;</description></item><item><title>2025-06-12 Weaviate使用（一） 使用ollama启用大模型和向量模型</title><link>https://huizhixu.github.io/chs/know_how/20250612weaviate%E4%BD%BF%E7%94%A8_%E4%BD%BF%E7%94%A8ollama%E5%90%AF%E7%94%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%92%8C%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8B/</link><pubDate>Thu, 12 Jun 2025 12:50:29 +0000</pubDate><guid>https://huizhixu.github.io/chs/know_how/20250612weaviate%E4%BD%BF%E7%94%A8_%E4%BD%BF%E7%94%A8ollama%E5%90%AF%E7%94%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%92%8C%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8B/</guid><description>&lt;h2 id="先决条件"&gt;先决条件&lt;/h2&gt;
&lt;p&gt;在本地用docker-compose.yml部署Weaviate。因为使用Ollama来启动模型，所以在配置文件中要加上ENABLE_MODULES: &amp;rsquo;text2vec-ollama,generative-ollama'&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;---&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;services&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; weaviate&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; command&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;host
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;0.0&lt;/span&gt;.&lt;span style="color:#bd93f9"&gt;0.0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;port
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;8080&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;scheme
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; http
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; image&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; cr.weaviate.io&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;semitechnologies&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;weaviate&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;1.30&lt;/span&gt;.&lt;span style="color:#bd93f9"&gt;6&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ports&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;8080&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;8080&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;50051&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;50051&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; volumes&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt; weaviate_data&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;/var/lib/weaviate
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; restart&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; on&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;failure&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; environment&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; QUERY_DEFAULTS_LIMIT&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#bd93f9"&gt;25&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;true&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; PERSISTENCE_DATA_PATH&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;/var/lib/weaviate&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ENABLE_API_BASED_MODULES&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;true&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ENABLE_MODULES&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;text2vec-ollama,generative-ollama&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; CLUSTER_HOSTNAME&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;node1&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;volumes&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; weaviate_data&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在本地安装启动Weaviate之后，运行&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; weaviate
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;client &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; weaviate.connect_to_local()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(client.is_ready())
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;True表示这个数据库是可用的。&lt;/p&gt;
&lt;h2 id="准备数据"&gt;准备数据&lt;/h2&gt;
&lt;p&gt;下面是jeopardy_tiny.json的例子&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;[
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Category&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;SCIENCE&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Question&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;This organ removes excess glucose from the blood &amp;amp; stores it as glycogen&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Answer&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Liver&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; },
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Category&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;ANIMALS&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Question&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;It&amp;#39;s the only living mammal in the order Proboseidea&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Answer&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Elephant&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; },
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Category&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;ANIMALS&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Question&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;The gavial looks very much like a crocodile except for this bodily feature&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;Answer&amp;#34;&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;:&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;the nose or snout&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="创建collection"&gt;创建collection&lt;/h2&gt;
&lt;p&gt;Ollama启动服务，api_endpoint统一为http://host.docker.internal:11434，模型根据模型名填写。&lt;/p&gt;</description></item><item><title>2024-05-25 用大模型理解爆火的KAN网络</title><link>https://huizhixu.github.io/chs/know_how/20240525kan_basic/</link><pubDate>Sat, 25 May 2024 16:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240525kan_basic/</guid><description>&lt;p&gt;五一假期的时候，KAN突然成为了热门话题。虽然最初我并没有计划弄懂它，但在老板的要求下，我还是探索了一下。&lt;/p&gt;
&lt;h2 id="一kan是什么"&gt;一、KAN是什么？&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Kolmogorov-Arnold 定理是数学领域的一个里程碑，它揭示了多元函数能够通过一组更简单的函数来近似表示的原理。&lt;/strong&gt; 在神经网络的研究领域，来自 MIT 的杰出研究者 Ziming Liu 将这一定理巧妙地融入，提出了创新的 KANs（&lt;strong&gt;Kolmogorov-Arnold Networks&lt;/strong&gt;）概念。（GitHub地址：https://github.com/KindXiaoming/pykan）。&lt;/p&gt;</description></item><item><title>2024-05-13 大型语言模型在「想」什么呢？ — 浅谈大型语言模型的可解释性</title><link>https://huizhixu.github.io/chs/know_how/20240513explainable_llm/</link><pubDate>Mon, 13 May 2024 19:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240513explainable_llm/</guid><description>&lt;p&gt;Explainable 和 Interpretable的区别：&lt;/p&gt;
&lt;p&gt;Explainable： 事物本身是黑箱，我们尝试去解释它的行为或输出。&lt;/p&gt;
&lt;p&gt;Interpretable： 事物本身不是黑箱，其工作原理是清晰和可以理解的。&lt;/p&gt;</description></item><item><title>2024-04-22 用大语言模型打造AI Agent</title><link>https://huizhixu.github.io/chs/know_how/20240421ai_agent/</link><pubDate>Mon, 22 Apr 2024 23:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240421ai_agent/</guid><description>&lt;p&gt;人类需要的不仅仅是大模型，而是能做复杂的多步骤的任务的大模型，Agent因此诞生了。&lt;/p&gt;
&lt;h1 id="知名的ai-agent"&gt;知名的AI Agent&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;1. AutoGPT: &lt;a href="https://github.com/Significant-Gravitas/AutoGPT" target="_blank" rel="noopener"&gt;https://github.com/Significant-Gravitas/AutoGPT&lt;/a&gt;
&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;AutoGPT是一个由Significant Gravitas开发的开源项目,旨在创建一个自主的AI代理,能够持续地学习、成长并完成各种任务。&lt;/p&gt;</description></item><item><title>2024-04-14 让AI村民组成虚拟村庄会发生什么事</title><link>https://huizhixu.github.io/chs/know_how/20240414ai_virtual_town/</link><pubDate>Sun, 14 Apr 2024 19:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240414ai_virtual_town/</guid><description>&lt;p&gt;去年Agent很火的时候，就知道有斯坦福出的这个虚拟小镇的论文了，当时大家都很好奇，怎么能够让大语言模型来操纵agent做出非常复杂的行为呢？&lt;/p&gt;</description></item><item><title>2024-04-13 大型语言模型修炼史（第三阶段）</title><link>https://huizhixu.github.io/chs/know_how/20240413the-history-of-cultivating-llm_second_part/</link><pubDate>Sat, 13 Apr 2024 19:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240413the-history-of-cultivating-llm_second_part/</guid><description>&lt;h1 id="第三阶段参与实战打磨技巧"&gt;第三阶段：参与实战，打磨技巧&lt;/h1&gt;
&lt;p&gt;如何克服第二阶段的局限性呢？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;关键是用第一阶段的参数作为初始参数。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;（贝叶斯定理这不就来了嘛！）&lt;/p&gt;
&lt;p&gt;所以第三阶段是由第一阶段和第二阶段组合而成的：&lt;/p&gt;
&lt;p&gt;第一阶段：通过网络上任何语料学习而来的，叫做预训练Pretrain&lt;/p&gt;</description></item><item><title>2024-04-05 大型语言模型修炼史（第一、二阶段）</title><link>https://huizhixu.github.io/chs/know_how/20240405the-history-of-cultivating-llm/</link><pubDate>Fri, 05 Apr 2024 20:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240405the-history-of-cultivating-llm/</guid><description>&lt;h1 id="背景知识"&gt;背景知识&lt;/h1&gt;
&lt;p&gt;大模型的本质是文字接龙。输入一个未完成的句子，输出这个未完成的句子的下一个token。&lt;/p&gt;
&lt;p&gt;大模型可以看成是一个函数。$$ f(未完成的句子)= 下一个token $$这个函数是一个有数十亿个未知参数的函数。&lt;/p&gt;</description></item><item><title>2024-03-05 改进量的期望 Expected Improvement</title><link>https://huizhixu.github.io/chs/know_how/20240305expected-improvement/</link><pubDate>Tue, 05 Mar 2024 20:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240305expected-improvement/</guid><description>&lt;p&gt;在看正文之前，先复习一下期望（Expectation）：&lt;/p&gt;
&lt;p&gt;在统计学和概率论中，期望是一个衡量随机变量取值的中心趋势的指标。&lt;/p&gt;
&lt;p&gt;对于一个连续随机变量&lt;em&gt;X&lt;/em&gt;，其期望值可以通过以下公式计算：&lt;/p&gt;</description></item><item><title>2024-02-03 Bayesian Optimization</title><link>https://huizhixu.github.io/chs/know_how/20240203%E8%B4%9D%E5%8F%B6%E6%96%AF%E4%BC%98%E5%8C%96/</link><pubDate>Sat, 03 Feb 2024 17:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240203%E8%B4%9D%E5%8F%B6%E6%96%AF%E4%BC%98%E5%8C%96/</guid><description>&lt;p&gt;贝叶斯优化有重要的两步步：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;构造代理模型（surrogate model）&lt;/li&gt;
&lt;li&gt;由获取函数（acquisition function）来生成采样建议&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;贝叶斯优化中，因为不知道目标函数的closed-form，所以需要构造一个代理模型（surrogate model）来近似目标函数。记住，代理模型对目标函数的潜在分布进行建模。通常用gaussian process来作为代理模型，也可以用random forest来作为代理模型。（任何模型，只要它为函数提供后验估计，可以用来作为surrogate model）。&lt;/p&gt;</description></item><item><title>2024-02-22 grobid的使用</title><link>https://huizhixu.github.io/chs/know_how/20240222grobid%E7%9A%84%E4%BD%BF%E7%94%A8/</link><pubDate>Sat, 03 Feb 2024 17:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20240222grobid%E7%9A%84%E4%BD%BF%E7%94%A8/</guid><description>&lt;p&gt;最近被文本分块虐得不轻，看到有人介绍grobid，赶紧用上了。&lt;/p&gt;
&lt;h3 id="1-grobid-介绍"&gt;1. Grobid 介绍&lt;/h3&gt;
&lt;p&gt;Grobid 的全称是Generation of Bibliographic Data。它用机器学习来解析、提取文档。&lt;/p&gt;</description></item><item><title>2023-12-17 Gaussian Process Regression with GPyTorch</title><link>https://huizhixu.github.io/chs/know_how/20231217gaussian_process_regression_gpytorch/</link><pubDate>Sun, 17 Dec 2023 17:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20231217gaussian_process_regression_gpytorch/</guid><description>&lt;p&gt;这个例子主要是利用GPytorch，来实现高斯过程回归。&lt;/p&gt;
&lt;h1 id="计算mean"&gt;计算Mean&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;zero mean function &lt;code&gt;gpytorch.means.ZeroMean()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;constant mean function &lt;code&gt;gpytorch.means.ConstantMean()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;linear mean function &lt;code&gt;gpytorch.means.LinearMean()&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id="计算covariance"&gt;计算Covariance&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;RBFKernel &lt;code&gt;gpytorch.kernels.RBFKernel()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;adding a scaling coefficient: &lt;code&gt;kernels.ScaleKernel(gpytorch.kernels.RBFKernel())&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;一般会在核函数的输出上添加缩放系数。&lt;/p&gt;
&lt;p&gt;在核函数的输出上添加缩放系数是为了调整核函数的影响力。&lt;/p&gt;</description></item><item><title>2023-12-10 Gaussian Process in Practice 高斯过程实践</title><link>https://huizhixu.github.io/chs/know_how/20231210gaussian_process_in_practice/</link><pubDate>Sun, 10 Dec 2023 18:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20231210gaussian_process_in_practice/</guid><description>&lt;p&gt;这个例子主要是利用高斯过程的先验分布，将样本绘制成曲线。然后更新参数，利用后验分布获得新的曲线。&lt;/p&gt;
&lt;h2 id="1-先验分布"&gt;1. 先验分布&lt;/h2&gt;
&lt;h4 id="11-多变量高斯分布"&gt;1.1 多变量高斯分布&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;创建一个包含n个候选输入位置的列表${x_i，i=1,&amp;hellip;,n}$&lt;/li&gt;
&lt;li&gt;初始化均值向量μ和协方差矩阵K（含n x n个元素）
&lt;ul&gt;
&lt;li&gt;假设x_1和x_2是多维的矩阵。x_1是一个 m* d的矩阵，x_2是一个n&lt;em&gt;d的矩阵，那么K是一个m&lt;/em&gt;n的矩阵，$K[i,j] = k(x_1[i,:], x_2[j,:])$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;执行Cholesky分解K=LL T来获得L&lt;/li&gt;
&lt;li&gt;通过LN（0,I）获得N（0,K）上的一个样本并存储在f_prior中&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;multivariante_samples01 和multivariante_samples02 这两个function的作用是一样的，只不过有两种写法。&lt;/p&gt;</description></item><item><title>2023-12-07 Kernel Function 核函数</title><link>https://huizhixu.github.io/chs/know_how/20231207kernel_function/</link><pubDate>Thu, 07 Dec 2023 18:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20231207kernel_function/</guid><description>&lt;p&gt;这篇文章主要解决三个问题：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;正态分布的表示&lt;/li&gt;
&lt;li&gt;核函数是什么，有什么类型&lt;/li&gt;
&lt;li&gt;已知先验知识，如何计算后验分布&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="1-正态分布的表示"&gt;1. 正态分布的表示&lt;/h2&gt;
&lt;p&gt;正态分布一般表示为$f \sim N(0,K)$，书上写作 $p(f|x) = N(f|0,K)$。&lt;/p&gt;</description></item><item><title>2023-11-25 书籍 Bayesian Optimization Theory and Practice using Python 之Gaussian Process</title><link>https://huizhixu.github.io/chs/know_how/20231125gaussian_process/</link><pubDate>Sat, 25 Nov 2023 18:01:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20231125gaussian_process/</guid><description>&lt;h2 id="1-理解covariance-matrix"&gt;1. 理解covariance matrix&lt;/h2&gt;
&lt;p&gt;Gaussian Process is a stochastic process used to characterize the distribution over function.&lt;/p&gt;
&lt;p&gt;GP将一组有限的参数theta从一个连空间拓展到一个连续无限空间的一个无限函数f。&lt;/p&gt;
&lt;p&gt;假设我们有两个变量，X1和X2，它俩符合multivariate Gaussian distribution。&lt;/p&gt;</description></item><item><title>2023-11-20 论文 Uncertainty Quantification in Machine Learning for Engineering Design and Health Prognostics</title><link>https://huizhixu.github.io/chs/know_how/20231120uncertainty/</link><pubDate>Mon, 20 Nov 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20231120uncertainty/</guid><description>&lt;p&gt;Abstract&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;types
&lt;ul&gt;
&lt;li&gt;第一种分类
&lt;ul&gt;
&lt;li&gt;data uncertainty (measurement noise)&lt;/li&gt;
&lt;li&gt;model uncertainty ( limited data)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;第二种分类
&lt;ul&gt;
&lt;li&gt;epistemic uncertainty
&lt;ul&gt;
&lt;li&gt;认知上的不确定性，通常是由于没有足够的知识（数据）而产生&lt;/li&gt;
&lt;li&gt;can be reducible&lt;/li&gt;
&lt;li&gt;分为两类
&lt;ul&gt;
&lt;li&gt;model-form uncertainty
&lt;ul&gt;
&lt;li&gt;由于模型的选择导致，例如architectures, activation functions or kernel functions&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;parameter uncertainty
&lt;ul&gt;
&lt;li&gt;在训练过程产生，由于数据不够导致&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;aleatory uncertainty
&lt;ul&gt;
&lt;li&gt;stems from physical systems, 具有随机性, cannot be reducible&lt;/li&gt;
&lt;li&gt;e.g. noises&lt;/li&gt;
&lt;li&gt;这种类型的不确定性在ML模型里面被看成是似然函数的一部分(a part of the likelihood function)&lt;/li&gt;
&lt;li&gt;也被叫做data uncertainty&lt;/li&gt;
&lt;li&gt;捕捉这种不确定性的方式有：同方差 homoscedastic和异方差 heteroscedastic&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;例子：
&lt;ul&gt;
&lt;li&gt;test data和train data不同分布：epistemic uncertainty (model performs poorer in extrapolation than in interpolation)&lt;/li&gt;
&lt;li&gt;测量数据由仪器导致的误差是aleatory Unc， 大试如果由于精度原因导致，则属于epistemic unc，因为提高精度可以减少这个误差&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;causes&lt;/li&gt;
&lt;li&gt;methods:
&lt;ul&gt;
&lt;li&gt;Gaussian process regression
&lt;ul&gt;
&lt;li&gt;a ML method with UQ capability&lt;/li&gt;
&lt;li&gt;一般不用来quantify uncertainty of a final surrogate&lt;/li&gt;
&lt;li&gt;一般用来在高度不确定的采样空间里采样，来减少训练样本的数量
&lt;ul&gt;
&lt;li&gt;to build an accurate surrogate within some lower and upper bounds of input variables&lt;/li&gt;
&lt;li&gt;to find a globally optimally design for black-box objective function&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;一般不评估GPR的UQ质量
&lt;ul&gt;
&lt;li&gt;因为预测一般在pre-defined design bounds&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Bayesian neural network
&lt;ul&gt;
&lt;li&gt;Monte Carlo dropout as an alternative to traditional Bayesian neural network&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;neural network ensemble
&lt;ul&gt;
&lt;li&gt;neural network ensemble consisting of multiple neural networks&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;deterministic UQ methods&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;metrics
&lt;ul&gt;
&lt;li&gt;classification
&lt;ul&gt;
&lt;li&gt;probability can be viewed as uncertainty&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;regression
&lt;ul&gt;
&lt;li&gt;confidence interval :
&lt;ul&gt;
&lt;li&gt;没看懂： prediction may be 120 ± 15, in weeks, which represents a two-sided 95% confidence interval (i.e.,∼1.96 standard deviations subtracted from or added to the mean estimate assuming the model-predicted RUL follows a Gaussian distribution).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>2023-07-20Redash V10安装（在Ubuntu系统上用docker部署安装）</title><link>https://huizhixu.github.io/chs/know_how/20230720redash%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95/</link><pubDate>Thu, 20 Jul 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230720redash%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95/</guid><description>&lt;p&gt;市面上的Redash教程太混乱了，官方发布了不同的安装方式，但是写得不是很明白。基本上都会有一个重复安装和卸载的过程，是正常的。&lt;/p&gt;
&lt;p&gt;这次安装的经验就是：&lt;/p&gt;</description></item><item><title>2023-07-19Ubuntu上安装Docker</title><link>https://huizhixu.github.io/chs/know_how/20230719ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85docker/</link><pubDate>Wed, 19 Jul 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230719ubuntu%E4%B8%8A%E5%AE%89%E8%A3%85docker/</guid><description>&lt;h1 id="一设置docker-repository"&gt;一、设置Docker Repository&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;升级&lt;code&gt;apt-get&lt;/code&gt;到最新&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;get update
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;get install ca&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;certificates curl gnupg
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;添加Docker的官方GPG key&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo install &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;m &lt;span style="color:#bd93f9"&gt;0755&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;d &lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;etc&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;apt&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;keyrings
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;fsSL https:&lt;span style="color:#ff79c6"&gt;//&lt;/span&gt;download&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;docker&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;com&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;linux&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;ubuntu&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;gpg &lt;span style="color:#ff79c6"&gt;|&lt;/span&gt; sudo gpg &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;dearmor &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;o &lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;etc&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;apt&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;keyrings&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;docker&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;gpg
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo chmod a&lt;span style="color:#ff79c6"&gt;+&lt;/span&gt;r &lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;etc&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;apt&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;keyrings&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;docker&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;gpg
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;设置仓库&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;echo \
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;deb [arch=&amp;#34;&lt;/span&gt;$(dpkg &lt;span style="color:#ff79c6"&gt;--&lt;/span&gt;&lt;span style="color:#8be9fd;font-style:italic"&gt;print&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;architecture)&lt;span style="color:#f1fa8c"&gt;&amp;#34; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu &lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f1fa8c"&gt;&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt; &amp;#34;&lt;/span&gt;$(&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;etc&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;os&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;release &lt;span style="color:#ff79c6"&gt;&amp;amp;&amp;amp;&lt;/span&gt; echo &lt;span style="color:#f1fa8c"&gt;&amp;#34;$VERSION_CODENAME&amp;#34;&lt;/span&gt;)&lt;span style="color:#f1fa8c"&gt;&amp;#34; stable&amp;#34;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;|&lt;/span&gt; \
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sudo tee &lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;etc&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;apt&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;sources&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;list&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;d&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;docker&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;list &lt;span style="color:#ff79c6"&gt;&amp;gt;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;dev&lt;span style="color:#ff79c6"&gt;/&lt;/span&gt;null
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id="二安装docker-engine"&gt;二、安装Docker Engine&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;升级apt-get到最新&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;get update
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;安装最新版本的Docker Engine， containerd和Docker Compose&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo apt&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;get install docker&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;ce docker&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;ce&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;cli containerd&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;io docker&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;buildx&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;plugin docker&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;compose&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;plugin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;确保安装成功&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo docker run hello&lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;world
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id="三配置docker环境"&gt;三、配置Docker环境&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;#配置log文件大小&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo sh &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;c &lt;span style="color:#f1fa8c"&gt;&amp;#39;mkdir /etc/docker &amp;amp;&amp;amp; cat &amp;gt; /etc/docker/daemon.json &amp;lt;&amp;lt; EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;log-driver&amp;#34;&lt;/span&gt;:&lt;span style="color:#f1fa8c"&gt;&amp;#34;json-file&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#34;log-opts&amp;#34;&lt;/span&gt;:{ &lt;span style="color:#f1fa8c"&gt;&amp;#34;max-size&amp;#34;&lt;/span&gt; :&lt;span style="color:#f1fa8c"&gt;&amp;#34;50m&amp;#34;&lt;/span&gt;,&lt;span style="color:#f1fa8c"&gt;&amp;#34;max-file&amp;#34;&lt;/span&gt;:&lt;span style="color:#f1fa8c"&gt;&amp;#34;3&amp;#34;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;EOF&lt;span style="color:#f1fa8c"&gt;&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;#将当前用户加入docker组&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo usermod &lt;span style="color:#ff79c6"&gt;-&lt;/span&gt;aG docker $USER
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#6272a4"&gt;#启动docker服务并配置自启&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo systemctl start docker &lt;span style="color:#ff79c6"&gt;&amp;amp;&amp;amp;&lt;/span&gt; sudo systemctl enable docker
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 id="四参考"&gt;四、参考&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener"&gt;Docker官网安装&lt;/a&gt;
&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>2023-04-27GPU运行LLaMa模型——用HF的方式推理</title><link>https://huizhixu.github.io/chs/know_how/20230427gpu%E8%BF%90%E8%A1%8Cllama%E6%A8%A1%E5%9E%8Bhf%E6%96%B9%E5%BC%8F/</link><pubDate>Thu, 27 Apr 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230427gpu%E8%BF%90%E8%A1%8Cllama%E6%A8%A1%E5%9E%8Bhf%E6%96%B9%E5%BC%8F/</guid><description>&lt;p&gt;在GPU上运行中文LLaMa模型，主要是按照 &lt;a href="https://github.com/ymcui/Chinese-LLaMA-Alpaca" target="_blank" rel="noopener"&gt;https://github.com/ymcui/Chinese-LLaMA-Alpaca&lt;/a&gt;
 这个仓库的方法。
中文LLaMa模型和中文Alpaca的区别是：中文LLaMa在英文llama的基础上扩充了中文词表并且使用了中文数据进行二次训练。中文LLaMa只能进行单轮问答。中文Alpaca经过instruct-tuning 生成，可以进行多轮问答。本次实验主要是针对中文LLaMa模型。&lt;/p&gt;</description></item><item><title>2023-03-05用随机梯度下降来优化人生【转载】</title><link>https://huizhixu.github.io/chs/know_how/20230305%E7%94%A8%E9%9A%8F%E6%9C%BA%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%9D%A5%E4%BC%98%E5%8C%96%E4%BA%BA%E7%94%9F/</link><pubDate>Sun, 05 Mar 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230305%E7%94%A8%E9%9A%8F%E6%9C%BA%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%9D%A5%E4%BC%98%E5%8C%96%E4%BA%BA%E7%94%9F/</guid><description>&lt;h2 id="要有目标"&gt;要有目标。&lt;/h2&gt;
&lt;p&gt;你需要有目标。短的也好，长的也好。认真定下的也好，别人那里捡的也好。就跟随机梯度下降需要有个目标函数一样。&lt;/p&gt;
&lt;h2 id="目标要大"&gt;目标要大。&lt;/h2&gt;
&lt;p&gt;不管是人生目标还是目标函数，你最好不要知道最后可以走到哪里。如果你知道，那么你的目标就太简单了，可能是个凸函数。你可以在一开始的时候给自己一些小目标，例如期末考个80分，训练一个线性模型。但接下来得有更大的目标，财富自由也好，100亿参数的变形金刚也好，得足够一颗赛艇。&lt;/p&gt;</description></item><item><title>2023-03-01我都用chatGPT干了啥</title><link>https://huizhixu.github.io/chs/know_how/20230301%E6%88%91%E9%83%BD%E7%94%A8chatgpt%E5%B9%B2%E4%BA%86%E5%95%A5/</link><pubDate>Wed, 01 Mar 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230301%E6%88%91%E9%83%BD%E7%94%A8chatgpt%E5%B9%B2%E4%BA%86%E5%95%A5/</guid><description>&lt;ol&gt;
&lt;li&gt;写诗&lt;/li&gt;
&lt;li&gt;帮我写程序&lt;/li&gt;
&lt;li&gt;帮我debug&lt;/li&gt;
&lt;li&gt;帮我构造数据&lt;/li&gt;
&lt;li&gt;帮我优化Resume&lt;/li&gt;
&lt;li&gt;梳理NLP知识时，解释不清晰的名词，并给出例子&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>2023-02-20 chatGPT有可能是个骗局吗</title><link>https://huizhixu.github.io/chs/know_how/20230220chatgpt%E6%9C%89%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%AA%E9%AA%97%E5%B1%80%E5%90%97/</link><pubDate>Mon, 20 Feb 2023 20:07:58 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230220chatgpt%E6%9C%89%E5%8F%AF%E8%83%BD%E6%98%AF%E4%B8%AA%E9%AA%97%E5%B1%80%E5%90%97/</guid><description>&lt;p&gt;昨天读了一篇文章：&lt;a href="https://www.newyorker.com/tech/annals-of-technology/chatGPT-is-a-blurry-jpeg-of-the-web" target="_blank" rel="noopener"&gt;ChatGPT is a blurry JPEG of the web&lt;/a&gt;
。中文翻译在这：&lt;a href="http://www.chinawriter.com.cn/n1/2023/0213/c404090-32622497.html" target="_blank" rel="noopener"&gt;ChatGPT是网上所有文本的模糊图像&lt;/a&gt;
 ，无比同意这篇文章说的，&amp;ldquo;有一种模糊是可以接受的，那就是用不同的词重新陈述信息；对于完全捏造的模糊，当我们寻找事实时，我们认为这是不可接受的&amp;rdquo;。这就是我使用chatGPT的感受。&lt;/p&gt;</description></item><item><title>2023-02-16 如何理解Seq2seq</title><link>https://huizhixu.github.io/chs/know_how/20230216%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3seq2seq/</link><pubDate>Thu, 16 Feb 2023 18:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230216%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3seq2seq/</guid><description>&lt;p&gt;先搞清楚几个基本概念：&lt;/p&gt;
&lt;p&gt;Seq2seq是一个概念，它的表现形式就是有encoder和decoder的一个结构。换言之，有encoder和decoder就可以说这是一个Seq2seq模型。编码器或者解码器具体可以用CNN、RNN、LSTM或者attention来构建。&lt;/p&gt;</description></item><item><title>2023-02-13 chatGPT 在攻陷所有人</title><link>https://huizhixu.github.io/chs/know_how/20230213chatgpt%E5%9C%A8%E6%94%BB%E9%99%B7%E6%89%80%E6%9C%89%E4%BA%BA/</link><pubDate>Mon, 13 Feb 2023 20:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230213chatgpt%E5%9C%A8%E6%94%BB%E9%99%B7%E6%89%80%E6%9C%89%E4%BA%BA/</guid><description>&lt;p&gt;承认吧，现在全世界最火就是chatGPT。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;去参加了王建硕老师那边组织的关于chatGPT的讨论。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;会上的讨论：对新技术进行哲学思考无疑是最让我震撼的。正因为他们进行深度思考，才能真正看到事物的本质，才能正确判断事物的走向。&lt;/li&gt;
&lt;li&gt;从心理学和教育学来看，也开拓了我的眼界。&lt;/li&gt;
&lt;li&gt;从高效使用和商业化来看，它无疑会改变很多人的生活。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;chatGPT的使用感受很不错。&lt;/p&gt;</description></item><item><title>2023-02-09 如何理解自注意力机制</title><link>https://huizhixu.github.io/chs/know_how/20230209%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/</link><pubDate>Thu, 09 Feb 2023 08:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230209%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B%E6%9C%BA%E5%88%B6/</guid><description>&lt;h2 id="理解输入与输出"&gt;理解输入与输出&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;输入有可能是一个 vector，有可能是多个 vector&lt;/li&gt;
&lt;li&gt;输出：
&lt;ul&gt;
&lt;li&gt;一个序列对应一个 label。the whole sequence has a label
&lt;ul&gt;
&lt;li&gt;例子：在情感分析里面，This is good 对应的输入是多个 vector，输出为 positive，是一个vector。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;一个 vector 对应一个 label。一个序列对应多个 label。
&lt;ul&gt;
&lt;li&gt;例子：在词性标注里面，This is good 对应的输入是多个 vector，输出为 代词，动词，形容词。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;模型决定 label 的个数。seq2seq 任务
&lt;ul&gt;
&lt;li&gt;例子：在机器翻译里面，This is good 对应的输入是3个 vector，中文翻译是”不错“，输出为2个 vector。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="一个vector对应一个label的情况即输入和输出一样多也叫做sequence-labeling"&gt;一个vector对应一个label的情况，即输入和输出一样多，也叫做sequence labeling&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;例子： I saw a saw&lt;/li&gt;
&lt;li&gt;如何解决 sequence labeling 的问题：用 fully connected network 对每一个 input vector 进行作用&lt;/li&gt;
&lt;li&gt;弊端：
&lt;ul&gt;
&lt;li&gt;用 fully connected network 来输出，假设对 I saw a saw 做词性标注。对于 FC 层来说，两个 saw没有什么不同，但是他们实际上一个是动词，一个是名词。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;解决思路：考虑更多的上下文。每一个 fc 层，都对所有的输入作用。或者给他一个 window，作用于相邻的几个 input vector。但是作用还是有限，计算也很复杂。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我们想考虑整个 sequence，但是不想把 sequence 所有的数据都包括在里面，就有了 self-attention。&lt;/p&gt;</description></item><item><title>2023-01-31 如何用HuggingFace对不均衡类别进行分类</title><link>https://huizhixu.github.io/chs/know_how/20230131%E5%A6%82%E4%BD%95%E7%94%A8huggingface%E5%AF%B9%E4%B8%8D%E5%9D%87%E8%A1%A1%E7%B1%BB%E5%88%AB%E8%BF%9B%E8%A1%8C%E5%88%86%E7%B1%BB/</link><pubDate>Tue, 31 Jan 2023 19:31:50 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20230131%E5%A6%82%E4%BD%95%E7%94%A8huggingface%E5%AF%B9%E4%B8%8D%E5%9D%87%E8%A1%A1%E7%B1%BB%E5%88%AB%E8%BF%9B%E8%A1%8C%E5%88%86%E7%B1%BB/</guid><description>&lt;h2 id="数据均衡"&gt;数据均衡&lt;/h2&gt;
&lt;p&gt;做文本分类时，如果类别数量差别不大，可以用hugging face的Trainer类，训练代码如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; BertForSequenceClassification&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#f1fa8c"&gt;&amp;#34;bert-base-chinese&amp;#34;&lt;/span&gt;, num_labels&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#8be9fd;font-style:italic"&gt;len&lt;/span&gt;(labels),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; problem_type&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#f1fa8c"&gt;&amp;#34;multi_label_classification&amp;#34;&lt;/span&gt;, id2label&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;id2label,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; label2id&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;label2id)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tokenizer &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; BertTokenizerFast&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#f1fa8c"&gt;&amp;#34;bert-base-chinese&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;def&lt;/span&gt; &lt;span style="color:#50fa7b"&gt;compute_metrics&lt;/span&gt;(p):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; preds &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; p&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;predictions[&lt;span style="color:#bd93f9"&gt;0&lt;/span&gt;] &lt;span style="color:#ff79c6"&gt;if&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;isinstance&lt;/span&gt;(p&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;predictions,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;tuple&lt;/span&gt;) &lt;span style="color:#ff79c6"&gt;else&lt;/span&gt; p&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;predictions
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; result &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; multi_label_metrics(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; predictions&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;preds,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; labels&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;p&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;label_ids)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;return&lt;/span&gt; result
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;training_args &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; TrainingArguments(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; output_dir&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;model_directory, 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; learning_rate&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;5e-5&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; per_device_train_batch_size&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;2&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; per_device_eval_batch_size&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;2&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; num_train_epochs&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;3&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; dataloader_drop_last&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;True&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; weight_decay&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;0.01&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; save_steps&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;50&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; logging_steps&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;&lt;span style="color:#bd93f9"&gt;50&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;trainer &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; Trainer(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; model&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;model,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; args&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;training_args,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; train_dataset&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;data[&lt;span style="color:#f1fa8c"&gt;&amp;#34;train&amp;#34;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; eval_dataset&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;data[&lt;span style="color:#f1fa8c"&gt;&amp;#34;train&amp;#34;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; tokenizer&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;tokenizer,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; compute_metrics&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;compute_metrics
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;trainer&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;train()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;trainer&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;evaluate()
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;model_directory 是模型存储路径，data是数据。&lt;/p&gt;</description></item><item><title>2022-12-10 HuggingFace的Dataset的使用</title><link>https://huizhixu.github.io/chs/know_how/20221210huggingface%E7%9A%84dataset%E7%9A%84%E4%BD%BF%E7%94%A8/</link><pubDate>Sat, 10 Dec 2022 18:51:00 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20221210huggingface%E7%9A%84dataset%E7%9A%84%E4%BD%BF%E7%94%A8/</guid><description>&lt;h2 id="hub上的数据集"&gt;hub上的数据集&lt;a name="datasets from the hub"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;（这里不是互联网上任意的数据集，专指Huggingface的hub上面的，就是可以用关键字直接下载的）&lt;/p&gt;
&lt;p&gt;数据集可以在&lt;a href="https://huggingface.co/datasets" target="_blank" rel="noopener"&gt;https://huggingface.co/datasets&lt;/a&gt;
 找到，另外也可以用**&lt;code&gt;datasets.list_datasets()&lt;/code&gt;
来看有什么数据集，然后通过关键字下载。&lt;/p&gt;</description></item><item><title>2022-10-24 在程序里起名有很多要注意的</title><link>https://huizhixu.github.io/chs/know_how/20221024%E5%A6%82%E4%BD%95%E5%9C%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD%E8%B5%B7%E5%90%8D/</link><pubDate>Mon, 24 Oct 2022 20:51:00 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20221024%E5%A6%82%E4%BD%95%E5%9C%A8%E7%A8%8B%E5%BA%8F%E4%B8%AD%E8%B5%B7%E5%90%8D/</guid><description>&lt;p&gt;最近检查以前写的代码，发现我给不同的功能函数或者变量起的名不是很精确。 比如数据处理这个阶段，就很容易取 &lt;code&gt;data_process&lt;/code&gt;， &lt;code&gt;get_data&lt;/code&gt;，&lt;code&gt;process_data&lt;/code&gt;，&lt;code&gt;data_preprocess&lt;/code&gt;，&lt;code&gt;deal_with_data&lt;/code&gt; 这些名字。再比如很多类的主入口，我经常会写 &lt;code&gt;run()&lt;/code&gt;、&lt;code&gt;xx_driver()&lt;/code&gt; 等等。&lt;/p&gt;</description></item><item><title>2022-08-02 用 HanLP 分词时如何自定义词典</title><link>https://huizhixu.github.io/chs/know_how/20220802%E7%94%A8hanlp%E5%88%86%E8%AF%8D%E6%97%B6%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%8D%E5%85%B8/</link><pubDate>Tue, 02 Aug 2022 17:51:00 +0800</pubDate><guid>https://huizhixu.github.io/chs/know_how/20220802%E7%94%A8hanlp%E5%88%86%E8%AF%8D%E6%97%B6%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%8D%E5%85%B8/</guid><description>&lt;p&gt;在分词的过程中，碰到一个这样的句子：&lt;/p&gt;
&lt;p&gt;&amp;lsquo;&lt;code&gt;公司产品品质持续提升，单晶硅片用料比例大幅高于行业平均，单晶硅料价格上涨。&lt;/code&gt;&amp;rsquo;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;import&lt;/span&gt; hanlp
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tok &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; hanlp&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;load(hanlp&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;pretrained&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;tok&lt;span style="color:#ff79c6"&gt;.&lt;/span&gt;COARSE_ELECTRA_SMALL_ZH)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sentence &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;公司产品品质持续提升，单晶硅片用料比例大幅高于行业平均，单晶硅料价格上涨。&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sen_list &lt;span style="color:#ff79c6"&gt;=&lt;/span&gt; tok(sentence)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#8be9fd;font-style:italic"&gt;print&lt;/span&gt;(sen_list)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;[&lt;span style="color:#f1fa8c"&gt;&amp;#39;公司&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;产品&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;品质&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;持续&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;提升&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;，&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;单晶&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;硅&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;片&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;用&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;料&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;比例&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;大幅&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;高于&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;行业&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;平均&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;，&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;单晶&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;硅&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;料&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;价格&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;上涨&amp;#39;&lt;/span&gt;, &lt;span style="color:#f1fa8c"&gt;&amp;#39;。&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以看出来，这里“单晶硅片”，“单晶硅料”， 被分为了“单晶”“硅”“料”和“单晶”“硅”“片”。&lt;/p&gt;</description></item></channel></rss>